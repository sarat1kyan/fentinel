<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1400" height="1000" fill="#f0f4f8"/>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" font-size="26" font-weight="bold" fill="#1a1a1a">Enhanced DLP v2.0 - Microservices Architecture</text>
  
  <!-- Cloud/On-Premise Boundary -->
  <rect x="50" y="60" width="1300" height="400" fill="none" stroke="#4a90e2" stroke-width="2" stroke-dasharray="10,5" rx="10"/>
  <text x="80" y="85" font-size="14" fill="#4a90e2" font-weight="bold">Cloud Infrastructure (Kubernetes)</text>
  
  <!-- API Gateway Layer -->
  <g id="api-gateway">
    <rect x="100" y="100" width="1200" height="80" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5"/>
    <text x="700" y="125" text-anchor="middle" font-size="16" font-weight="bold" fill="#1976d2">API Gateway & Load Balancer</text>
    
    <rect x="150" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="220" y="155" text-anchor="middle" font-size="12">GraphQL API</text>
    
    <rect x="320" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="390" y="155" text-anchor="middle" font-size="12">REST API v2</text>
    
    <rect x="490" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="560" y="155" text-anchor="middle" font-size="12">WebSocket</text>
    
    <rect x="660" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="730" y="155" text-anchor="middle" font-size="12">gRPC</text>
    
    <rect x="830" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="900" y="155" text-anchor="middle" font-size="12">Auth Service</text>
    
    <rect x="1000" y="130" width="140" height="40" fill="#fff" stroke="#1976d2" rx="3"/>
    <text x="1070" y="155" text-anchor="middle" font-size="12">Rate Limiter</text>
  </g>
  
  <!-- Microservices Layer -->
  <g id="microservices">
    <!-- Policy Service -->
    <g>
      <rect x="100" y="220" width="200" height="120" fill="#fff3e0" stroke="#ff6f00" stroke-width="2" rx="5"/>
      <text x="200" y="245" text-anchor="middle" font-size="14" font-weight="bold" fill="#ff6f00">Policy Service</text>
      <rect x="115" y="260" width="170" height="25" fill="#fff" stroke="#ff6f00" rx="3"/>
      <text x="200" y="277" text-anchor="middle" font-size="11">Policy Engine v2</text>
      <rect x="115" y="295" width="170" height="25" fill="#fff" stroke="#ff6f00" rx="3"/>
      <text x="200" y="312" text-anchor="middle" font-size="11">ML Model Manager</text>
    </g>
    
    <!-- Detection Service -->
    <g>
      <rect x="320" y="220" width="200" height="120" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="5"/>
      <text x="420" y="245" text-anchor="middle" font-size="14" font-weight="bold" fill="#7b1fa2">Detection Service</text>
      <rect x="335" y="260" width="170" height="25" fill="#fff" stroke="#7b1fa2" rx="3"/>
      <text x="420" y="277" text-anchor="middle" font-size="11">Pattern Matching</text>
      <rect x="335" y="295" width="170" height="25" fill="#fff" stroke="#7b1fa2" rx="3"/>
      <text x="420" y="312" text-anchor="middle" font-size="11">ML Classification</text>
    </g>
    
    <!-- Analytics Service -->
    <g>
      <rect x="540" y="220" width="200" height="120" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" rx="5"/>
      <text x="640" y="245" text-anchor="middle" font-size="14" font-weight="bold" fill="#2e7d32">Analytics Service</text>
      <rect x="555" y="260" width="170" height="25" fill="#fff" stroke="#2e7d32" rx="3"/>
      <text x="640" y="277" text-anchor="middle" font-size="11">Behavioral Analysis</text>
      <rect x="555" y="295" width="170" height="25" fill="#fff" stroke="#2e7d32" rx="3"/>
      <text x="640" y="312" text-anchor="middle" font-size="11">Anomaly Detection</text>
    </g>
    
    <!-- Threat Intelligence -->
    <g>
      <rect x="760" y="220" width="200" height="120" fill="#fce4ec" stroke="#c2185b" stroke-width="2" rx="5"/>
      <text x="860" y="245" text-anchor="middle" font-size="14" font-weight="bold" fill="#c2185b">Threat Intelligence</text>
      <rect x="775" y="260" width="170" height="25" fill="#fff" stroke="#c2185b" rx="3"/>
      <text x="860" y="277" text-anchor="middle" font-size="11">External Feeds</text>
      <rect x="775" y="295" width="170" height="25" fill="#fff" stroke="#c2185b" rx="3"/>
      <text x="860" y="312" text-anchor="middle" font-size="11">Risk Scoring</text>
    </g>
    
    <!-- Forensics Service -->
    <g>
      <rect x="980" y="220" width="200" height="120" fill="#e1f5fe" stroke="#0277bd" stroke-width="2" rx="5"/>
      <text x="1080" y="245" text-anchor="middle" font-size="14" font-weight="bold" fill="#0277bd">Forensics Service</text>
      <rect x="995" y="260" width="170" height="25" fill="#fff" stroke="#0277bd" rx="3"/>
      <text x="1080" y="277" text-anchor="middle" font-size="11">Incident Timeline</text>
      <rect x="995" y="295" width="170" height="25" fill="#fff" stroke="#0277bd" rx="3"/>
      <text x="1080" y="312" text-anchor="middle" font-size="11">Evidence Collection</text>
    </g>
  </g>
  
  <!-- Data Layer -->
  <g id="data-layer">
    <rect x="100" y="370" width="1200" height="70" fill="#f5f5f5" stroke="#616161" stroke-width="2" rx="5"/>
    <text x="700" y="395" text-anchor="middle" font-size="14" font-weight="bold" fill="#616161">Data Layer</text>
    
    <rect x="150" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="210" y="420" text-anchor="middle" font-size="11">PostgreSQL</text>
    
    <rect x="300" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="360" y="420" text-anchor="middle" font-size="11">MongoDB</text>
    
    <rect x="450" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="510" y="420" text-anchor="middle" font-size="11">Redis Cache</text>
    
    <rect x="600" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="660" y="420" text-anchor="middle" font-size="11">Elasticsearch</text>
    
    <rect x="750" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="810" y="420" text-anchor="middle" font-size="11">InfluxDB</text>
    
    <rect x="900" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="960" y="420" text-anchor="middle" font-size="11">Kafka</text>
    
    <rect x="1050" y="400" width="120" height="30" fill="#fff" stroke="#616161" rx="3"/>
    <text x="1110" y="420" text-anchor="middle" font-size="11">S3/MinIO</text>
  </g>
  
  <!-- Agent Infrastructure -->
  <text x="80" y="490" font-size="14" fill="#333" font-weight="bold">Agent Infrastructure</text>
  
  <!-- Enhanced Agents -->
  <g id="enhanced-agents">
    <!-- Linux Agent v2 -->
    <g>
      <rect x="100" y="510" width="250" height="180" fill="#fff5e6" stroke="#ff6600" stroke-width="2" rx="5"/>
      <text x="225" y="535" text-anchor="middle" font-size="14" font-weight="bold" fill="#ff6600">Linux Agent v2</text>
      
      <rect x="115" y="550" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="165" y="567" text-anchor="middle" font-size="10">eBPF Core</text>
      
      <rect x="235" y="550" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="285" y="567" text-anchor="middle" font-size="10">FUSE Driver</text>
      
      <rect x="115" y="580" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="165" y="597" text-anchor="middle" font-size="10">Container Hook</text>
      
      <rect x="235" y="580" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="285" y="597" text-anchor="middle" font-size="10">K8s Operator</text>
      
      <rect x="115" y="610" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="165" y="627" text-anchor="middle" font-size="10">GPU Monitor</text>
      
      <rect x="235" y="610" width="100" height="25" fill="#fff" stroke="#ff6600" rx="3"/>
      <text x="285" y="627" text-anchor="middle" font-size="10">Hardware Crypto</text>
      
      <rect x="175" y="645" width="100" height="25" fill="#ffcc80" stroke="#ff6600" rx="3"/>
      <text x="225" y="662" text-anchor="middle" font-size="10">ML Inference</text>
    </g>
    
    <!-- Windows Agent v2 -->
    <g>
      <rect x="380" y="510" width="250" height="180" fill="#e6f3ff" stroke="#0066ff" stroke-width="2" rx="5"/>
      <text x="505" y="535" text-anchor="middle" font-size="14" font-weight="bold" fill="#0066ff">Windows Agent v2</text>
      
      <rect x="395" y="550" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="445" y="567" text-anchor="middle" font-size="10">WFP Enhanced</text>
      
      <rect x="515" y="550" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="565" y="567" text-anchor="middle" font-size="10">Minifilter</text>
      
      <rect x="395" y="580" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="445" y="597" text-anchor="middle" font-size="10">WMI Events</text>
      
      <rect x="515" y="580" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="565" y="597" text-anchor="middle" font-size="10">Hyper-V Hook</text>
      
      <rect x="395" y="610" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="445" y="627" text-anchor="middle" font-size="10">TPM Integration</text>
      
      <rect x="515" y="610" width="100" height="25" fill="#fff" stroke="#0066ff" rx="3"/>
      <text x="565" y="627" text-anchor="middle" font-size="10">BitLocker API</text>
      
      <rect x="455" y="645" width="100" height="25" fill="#90caf9" stroke="#0066ff" rx="3"/>
      <text x="505" y="662" text-anchor="middle" font-size="10">ONNX Runtime</text>
    </g>
    
    <!-- macOS Agent v2 -->
    <g>
      <rect x="660" y="510" width="250" height="180" fill="#f0f0f0" stroke="#666" stroke-width="2" rx="5"/>
      <text x="785" y="535" text-anchor="middle" font-size="14" font-weight="bold" fill="#666">macOS Agent v2</text>
      
      <rect x="675" y="550" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="725" y="567" text-anchor="middle" font-size="10">ES API v2</text>
      
      <rect x="795" y="550" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="845" y="567" text-anchor="middle" font-size="10">Swift Runtime</text>
      
      <rect x="675" y="580" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="725" y="597" text-anchor="middle" font-size="10">Transparent Proxy</text>
      
      <rect x="795" y="580" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="845" y="597" text-anchor="middle" font-size="10">Virtualization</text>
      
      <rect x="675" y="610" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="725" y="627" text-anchor="middle" font-size="10">T2 Chip API</text>
      
      <rect x="795" y="610" width="100" height="25" fill="#fff" stroke="#666" rx="3"/>
      <text x="845" y="627" text-anchor="middle" font-size="10">FileVault API</text>
      
      <rect x="735" y="645" width="100" height="25" fill="#bdbdbd" stroke="#666" rx="3"/>
      <text x="785" y="662" text-anchor="middle" font-size="10">CoreML</text>
    </g>
    
    <!-- Cloud Agent -->
    <g>
      <rect x="940" y="510" width="250" height="180" fill="#e8eaf6" stroke="#5e35b1" stroke-width="2" rx="5"/>
      <text x="1065" y="535" text-anchor="middle" font-size="14" font-weight="bold" fill="#5e35b1">Cloud Agent</text>
      
      <rect x="955" y="550" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1005" y="567" text-anchor="middle" font-size="10">AWS Hook</text>
      
      <rect x="1075" y="550" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1125" y="567" text-anchor="middle" font-size="10">Azure Monitor</text>
      
      <rect x="955" y="580" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1005" y="597" text-anchor="middle" font-size="10">GCP Security</text>
      
      <rect x="1075" y="580" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1125" y="597" text-anchor="middle" font-size="10">Lambda Proxy</text>
      
      <rect x="955" y="610" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1005" y="627" text-anchor="middle" font-size="10">S3 Scanner</text>
      
      <rect x="1075" y="610" width="100" height="25" fill="#fff" stroke="#5e35b1" rx="3"/>
      <text x="1125" y="627" text-anchor="middle" font-size="10">CASB Connect</text>
      
      <rect x="1015" y="645" width="100" height="25" fill="#b39ddb" stroke="#5e35b1" rx="3"/>
      <text x="1065" y="662" text-anchor="middle" font-size="10">SageMaker</text>
    </g>
  </g>
  
  <!-- Advanced Features -->
  <g id="advanced-features">
    <rect x="100" y="720" width="1200" height="80" fill="#e8f5e9" stroke="#00897b" stroke-width="2" rx="5"/>
    <text x="700" y="745" text-anchor="middle" font-size="14" font-weight="bold" fill="#00897b">Advanced Features</text>
    
    <rect x="130" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="195" y="780" text-anchor="middle" font-size="11">Zero Trust</text>
    
    <rect x="280" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="345" y="780" text-anchor="middle" font-size="11">Data Discovery</text>
    
    <rect x="430" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="495" y="780" text-anchor="middle" font-size="11">Classification</text>
    
    <rect x="580" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="645" y="780" text-anchor="middle" font-size="11">Lineage Tracking</text>
    
    <rect x="730" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="795" y="780" text-anchor="middle" font-size="11">SOAR Integration</text>
    
    <rect x="880" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="945" y="780" text-anchor="middle" font-size="11">Compliance</text>
    
    <rect x="1030" y="760" width="130" height="30" fill="#fff" stroke="#00897b" rx="3"/>
    <text x="1095" y="780" text-anchor="middle" font-size="11">Privacy Controls</text>
  </g>
  
  <!-- Monitoring Dashboard -->
  <g id="monitoring">
    <rect x="100" y="830" width="1200" height="80" fill="#fff3e0" stroke="#ff8f00" stroke-width="2" rx="5"/>
    <text x="700" y="855" text-anchor="middle" font-size="14" font-weight="bold" fill="#ff8f00">Monitoring & Observability</text>
    
    <rect x="200" y="870" width="150" height="30" fill="#fff" stroke="#ff8f00" rx="3"/>
    <text x="275" y="890" text-anchor="middle" font-size="11">Prometheus/Grafana</text>
    
    <rect x="400" y="870" width="150" height="30" fill="#fff" stroke="#ff8f00" rx="3"/>
    <text x="475" y="890" text-anchor="middle" font-size="11">ELK Stack</text>
    
    <rect x="600" y="870" width="150" height="30" fill="#fff" stroke="#ff8f00" rx="3"/>
    <text x="675" y="890" text-anchor="middle" font-size="11">Jaeger Tracing</text>
    
    <rect x="800" y="870" width="150" height="30" fill="#fff" stroke="#ff8f00" rx="3"/>
    <text x="875" y="890" text-anchor="middle" font-size="11">Custom Dashboard</text>
    
    <rect x="1000" y="870" width="150" height="30" fill="#fff" stroke="#ff8f00" rx="3"/>
    <text x="1075" y="890" text-anchor="middle" font-size="11">Alert Manager</text>
  </g>
  
  <!-- Connection lines -->
  <g stroke="#999" stroke-width="1.5" fill="none">
    <!-- API to Services -->
    <line x1="700" y1="180" x2="200" y2="220" stroke-dasharray="3,3"/>
    <line x1="700" y1="180" x2="420" y2="220" stroke-dasharray="3,3"/>
    <line x1="700" y1="180" x2="640" y2="220" stroke-dasharray="3,3"/>
    <line x1="700" y1="180" x2="860" y2="220" stroke-dasharray="3,3"/>
    <line x1="700" y1="180" x2="1080" y2="220" stroke-dasharray="3,3"/>
    
    <!-- Services to Data -->
    <line x1="640" y1="340" x2="640" y2="370"/>
    
    <!-- Agents to Cloud -->
    <line x1="225" y1="510" x2="400" y2="440" stroke-dasharray="2,2"/>
    <line x1="505" y1="510" x2="600" y2="440" stroke-dasharray="2,2"/>
    <line x1="785" y1="510" x2="800" y2="440" stroke-dasharray="2,2"/>
    <line x1="1065" y1="510" x2="1000" y2="440" stroke-dasharray="2,2"/>
  </g>
  
  <!-- Legend -->
  <g id="legend" transform="translate(1220, 520)">
    <rect width="150" height="170" fill="#fff" stroke="#999" rx="5"/>
    <text x="75" y="20" text-anchor="middle" font-size="12" font-weight="bold">Components</text>
    
    <rect x="10" y="30" width="15" height="15" fill="#e3f2fd"/>
    <text x="30" y="42" font-size="10">API Layer</text>
    
    <rect x="10" y="50" width="15" height="15" fill="#fff3e0"/>
    <text x="30" y="62" font-size="10">Core Services</text>
    
    <rect x="10" y="70" width="15" height="15" fill="#f5f5f5"/>
    <text x="30" y="82" font-size="10">Data Storage</text>
    
    <rect x="10" y="90" width="15" height="15" fill="#fff5e6"/>
    <text x="30" y="102" font-size="10">OS Agents</text>
    
    <rect x="10" y="110" width="15" height="15" fill="#e8f5e9"/>
    <text x="30" y="122" font-size="10">Features</text>
    
    <rect x="10" y="130" width="15" height="15" fill="#fff3e0"/>
    <text x="30" y="142" font-size="10">Monitoring</text>
  </g>
</svg>